<script>
(function() {
  const TIMEOUT = 1000;
  let done = false;

  if (!document.querySelector('.math, .math-display, .math-inline')) return;

  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    },
    startup: { typeset: false }
  };

  const s = document.createElement('script');
  s.src = '/assets/js/mathjax/es5/tex-chtml-full.js';
  s.async = true;

  s.onload = () => {
    done = true;
    MathJax.typesetPromise(document.querySelectorAll('.math, .math-display, .math-inline'));
  };

  document.head.appendChild(s);

  setTimeout(() => {
    if (!done) {
      console.warn('MathJax لود نشد، ادامه بدون فرمول.');
      window.MathJax = undefined;
    }
  }, TIMEOUT);
})();
</script>
